<!DOCTYPE html>
<html lang="en-US">
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="robots" content="noindex, nofollow">
<script>// Make *any* pre with class 'sagecell-sage' an executable Sage cell
// Their results will be linked, only within language type
sagecell.makeSagecell({inputLocation: 'pre.sagecell-sage',
                       linked: true,
                       languages: ['sage'],
                       evalButtonText: 'Evaluate (Sage)'});
</script>
</head>
<body class="ignore-math">
<article class="project project-like"><h4 class="heading">
<span class="type">Sage example</span><span class="space"> </span><span class="codenumber">9</span><span class="period">.</span><span class="space"> </span><span class="title">Solving matrix equations.</span>
</h4> <div class="para logical">
<div class="para">Let’s use Sage and  <a href="" class="xref" data-knowl="./knowl/cor_matrix_equations.html" title="Corollary 3.4.16: Solutions to matrix equations">Corollary 3.4.16</a> to find the set of solutions <span class="process-math">\(S\subseteq \R^5\)</span> to the matrix equation</div>
<div class="displaymath process-math" data-contains-math-knowls="./knowl/cor_matrix_equations.html ./knowl/sage_solve_system.html ./knowl/eq_sage_matrix_eqn.html">
\begin{equation}
\begin{amatrix}[rrrrr]
0\amp 0\amp -2\amp 0\amp 7\\
2\amp 4\amp -10\amp 6\amp 12\\
2\amp 4\amp -5\amp 6\amp -5
\end{amatrix}
\begin{amatrix}[c] x_1\\ x_2\\ x_3\\ x_4\\ x_5   \end{amatrix}=
\begin{amatrix}[r] 12\\ 28\\ -1  \end{amatrix}\text{.}\tag{3.4.5}
\end{equation}
</div>
<div class="para">This is the matrix equation form of the linear system we investigated in <a href="" class="xref" data-knowl="./knowl/sage_solve_system.html" title="Sage example 2: Solving linear systems">Sage example 2</a>. The method <code class="code-inline tex2jax_ignore">solve_right</code> can be used to find a <em class="emphasis">particular solution</em> <span class="process-math">\(\boldx_p\)</span> to <a href="" class="xref" data-knowl="./knowl/eq_sage_matrix_eqn.html" title="Equation 3.4.5">(3.4.5)</a>.</div>
</div> <pre class="ptx-sagecell sagecell-sage" id="sage-31"><script type="text/x-sage">A=Matrix([[0,0,-2,0,7],[2,4,-10,6,12],[2,4,-5,6,-5]])
b=vector([12,28,-1])
xp=A.solve_right(b)
show(xp)
show(A*xp) # Check xp is solution
</script></pre> <div class="para logical">
<div class="para">We get the entire set of solutions <span class="process-math">\(S\)</span> by translating <span class="process-math">\(\NS A\)</span> by the particular solution <span class="process-math">\(\boldx_p\text{:}\)</span>
</div>
<div class="displaymath process-math" data-contains-math-knowls="./knowl/eq_sage_matrix_eqn.html">
\begin{equation*}
S=\{\boldx_p+\boldu\colon \boldu\in \NS A\}=\boldx_p+\NS A\text{.}
\end{equation*}
</div>
<div class="para">We can illustrate this in Sage by taking random elements of <span class="process-math">\(\NS A\)</span> (computed using <code class="code-inline tex2jax_ignore">right_kernel</code>), adding them to <code class="code-inline tex2jax_ignore">xp</code>, and verifying that the result is a solution to <a href="" class="xref" data-knowl="./knowl/eq_sage_matrix_eqn.html" title="Equation 3.4.5">(3.4.5)</a>. Each time you evaluate the cell below, a randomly generated element of <span class="process-math">\(S\)</span> will be outputted.</div>
</div> <pre class="ptx-sagecell sagecell-sage" id="sage-32"><script type="text/x-sage">NS=A.right_kernel()
u=NS.random_element(1,-50,50)
x=xp+u
show(x) # A solution
show(A*x) # Check that A*x=(12,28,-1)
</script></pre> <div class="para">You may wonder just how random these elements of <span class="process-math">\(S\)</span> are, considering that the entries always seem to be integers! Indeed, soliciting information about <code class="code-inline tex2jax_ignore">NS</code> from Sage, we see that it has the structure of a “free module” defined over the the “Integer Ring”.</div> <pre class="ptx-sagecell sagecell-sage" id="sage-33"><script type="text/x-sage">NS
</script></pre> <div class="para">Without getting too far into the weeds, this is a result of our initial definition of <span class="process-math">\(A\)</span> using <code class="code-inline tex2jax_ignore">Matrix()</code>. Without further information, Sage interprets this as a matrix with <em class="emphasis">integer</em> coefficients, as opposed to <em class="emphasis">real</em> coefficients. All further computations (e.g., <code class="code-inline tex2jax_ignore">xp</code> and <code class="code-inline tex2jax_ignore">NS</code>) are done in a similar spirit. More precisely, the object <code class="code-inline tex2jax_ignore">NS</code> generated by Sage consists of all <em class="emphasis">integer</em> linear combinations of the two rows in the “echelon basis matrix” displayed in the cell above. The next cell shows you how things change when we alert Sage to the fact that we are dealing with matrices over the reals. The only change is adding <code class="code-inline tex2jax_ignore">RR</code> to <code class="code-inline tex2jax_ignore">Matrix()</code>, which specifies that matrix coefficients should be understood as real numbers.</div> <pre class="ptx-sagecell sagecell-sage" id="sage-34"><script type="text/x-sage">A=Matrix(RR,[[0,0,-2,0,7],[2,4,-10,6,12],[2,4,-5,6,-5]])
b=vector([12,28,-1])
xp=A.solve_right(b)
NS=A.right_kernel()
u=NS.random_element(1,-50,50)
x=xp+u
show(x) # A solution
show(A*x) # Check that A*x=(12,28,-1)
</script></pre></article><span class="incontext"><a href="s_nullspace_image.html#sage_solve_matrix_eqn" class="internal">in-context</a></span>
</body>
</html>
